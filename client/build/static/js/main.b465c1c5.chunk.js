(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{73:function(e,t,a){e.exports=a(87)},78:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n,r,c,l,o,i,s,u,m,d,h,g=a(1),b=a.n(g),p=a(63),f=a.n(p),v=(a(78),a(12)),E=a(10),j=a(7),y=a(68),O=a(89),w=a(100),N=a(98),x=a(67),k=a(14),_=a(15),C=a(53),S=a.n(C),$=new(function(){function e(){Object(k.a)(this,e)}return Object(_.a)(e,[{key:"getProfile",value:function(){return S()(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return S()(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}()),T=function(){return b.a.createElement("header",{className:"bg-secondary mb-4 py-2 flex-row align-center"},b.a.createElement("div",{className:"container flex-row justify-space-between-lg justify-center align-center"},b.a.createElement(E.b,{to:"/"},b.a.createElement("h1",null,"Deep Thoughts")),b.a.createElement("nav",{className:"text-center"},$.loggedIn()?b.a.createElement(b.a.Fragment,null,b.a.createElement(E.b,{to:"/profile"},"Me"),b.a.createElement("a",{href:"/",onClick:function(e){e.preventDefault(),$.logout()}},"Logout")):b.a.createElement(b.a.Fragment,null,b.a.createElement(E.b,{to:"/login"},"Login"),b.a.createElement(E.b,{to:"/signup"},"Signup")))))},I=function(){return b.a.createElement("footer",{className:"w-100 mt-auto bg-secondary p-4"},b.a.createElement("div",{className:"container"},"\xa9",(new Date).getFullYear()," by Ibrahim"))},A=function(e){var t=e.thoughts,a=e.title;return t.length?b.a.createElement("div",null,b.a.createElement("h3",null,a),t&&t.map((function(e){return b.a.createElement("div",{key:e._id,className:"card mb-3"},b.a.createElement("p",{className:"card-header"},b.a.createElement(E.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},className:"text-light"},e.username)," ","thought on ",e.createdAt),b.a.createElement("div",{className:"card-body"},b.a.createElement(E.b,{to:"/thought/".concat(e._id)},b.a.createElement("p",null,e.thoughtText),b.a.createElement("p",{className:"mb-0"},"Reactions: ",e.reactionCount," || Click to"," ",e.reactionCount?"see":"start"," the discussion!"))))}))):b.a.createElement("h3",null,"No Thoughts Yet")},F=function(e){var t=e.friendCount,a=e.username,n=e.friends;return n&&n.length?b.a.createElement("div",null,b.a.createElement("h5",null,a,"'s ",t," ",1===t?"friend":"friends"),n.map((function(e){return b.a.createElement("button",{className:"btn w-100 display-block mb-2",key:e._id},b.a.createElement(E.b,{to:"/profile/".concat(e.username)},e.username))}))):b.a.createElement("p",{className:"bg-dark text-light p-3"},a,", make some friends!")},D=a(20),B=a.n(D),L=a(30),q=a(32),Y=a(8),U=a(92),P=a(19),Q=a(99),R=Object(Q.a)(n||(n=Object(P.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),W=Object(Q.a)(r||(r=Object(P.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),J=Object(Q.a)(c||(c=Object(P.a)(["\n  mutation addThought($thoughtText: String!) {\n    addThought(thoughtText: $thoughtText) {\n      _id\n      thoughtText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n      }\n    }\n  }\n"]))),M=(Object(Q.a)(l||(l=Object(P.a)(["\n  mutation addReaction($thoughtId: ID!, $reactionBody: String!) {\n    addReaction(thoughtId: $thoughtId, reactionBody: $reactionBody) {\n      _id\n      reactionCount\n      reactions {\n        _id\n        reactionBody\n        createdAt\n        username\n      }\n    }\n  }\n"]))),Object(Q.a)(o||(o=Object(P.a)(["\n  mutation addFriend($id: ID!) {\n    addFriend(friendId: $id) {\n      _id\n      username\n      friendCount\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"])))),z=(Object(Q.a)(i||(i=Object(P.a)(["\n  mutation removeFriend($id: ID!) {\n    removeFriend(id: $id) {\n      _id\n      username\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),Object(Q.a)(s||(s=Object(P.a)(["\n  query thoughts($username: String) {\n    thoughts(username: $username) {\n      _id\n      thoughtText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n        createdAt\n        username\n        reactionBody\n      }\n    }\n  }\n"])))),H=Object(Q.a)(u||(u=Object(P.a)(["\n  query thought($id: ID!) {\n    thought(_id: $id) {\n      _id\n      thoughtText\n      createdAt\n      username\n      reactionCount\n      reactions {\n        _id\n        createdAt\n        username\n        reactionBody\n      }\n    }\n  }\n"]))),V=Object(Q.a)(m||(m=Object(P.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n      thoughts {\n        _id\n        thoughtText\n        createdAt\n        reactionCount\n      }\n    }\n  }\n"]))),G=Object(Q.a)(d||(d=Object(P.a)(["\n  {\n    me {\n      _id\n      username\n      email\n      friendCount\n      thoughts {\n        _id\n        thoughtText\n        createdAt\n        reactionCount\n        reactions {\n          _id\n          createdAt\n          reactionBody\n          username\n        }\n      }\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),K=Object(Q.a)(h||(h=Object(P.a)(["\n  {\n    me {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),X=function(){var e=Object(g.useState)(""),t=Object(Y.a)(e,2),a=t[0],n=t[1],r=Object(g.useState)(0),c=Object(Y.a)(r,2),l=c[0],o=c[1],i=Object(U.a)(J,{update:function(e,t){var a=t.data.addThought;try{var n=e.readQuery({query:z}).thoughts;e.writeQuery({query:z,data:{thoughts:[a].concat(Object(q.a)(n))}})}catch(c){console.error(c)}var r=e.readQuery({query:G}).me;e.writeQuery({query:G,data:{me:Object(v.a)(Object(v.a)({},r),{},{thoughts:[].concat(Object(q.a)(r.thoughts),[a])})}})}}),s=Object(Y.a)(i,2),u=s[0],m=s[1].error,d=function(){var e=Object(L.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,u({variables:{thoughtText:a}});case 4:n(""),o(0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return b.a.createElement("div",null,b.a.createElement("p",{className:"m-0 ".concat(280===l||m?"text-error":"")},"Character Count: ",l,"/280",m&&b.a.createElement("span",{className:"ml-2"},"Something went wrong...")),b.a.createElement("form",{className:"flex-row justify-center justify-space-between-md align-stretch",onSubmit:d},b.a.createElement("textarea",{placeholder:"Here's a new thought...",value:a,className:"form-input col-12 col-md-9",onChange:function(e){e.target.value.length<=280&&(n(e.target.value),o(e.target.value.length))}}),b.a.createElement("button",{className:"btn col-12 col-md-3",type:"submit"},"Submit")))},Z=a(97),ee=function(){var e=Object(Z.a)(z),t=e.loading,a=e.data,n=Object(Z.a)(K).data,r=(null===a||void 0===a?void 0:a.thoughts)||[],c=$.loggedIn();return b.a.createElement("main",null,b.a.createElement("div",{className:"flex-row justify-space-between"},c&&b.a.createElement("div",{className:"col-12 mb-3"},b.a.createElement(X,null)),b.a.createElement("div",{className:"col-12 mb-3 ".concat(c&&"col-lg-8")},t?b.a.createElement("div",null,"Loading..."):b.a.createElement(A,{thoughts:r,title:"Some Feed for Thought(s)..."})),c&&n?b.a.createElement("div",{className:"col-12 col-lg-3 mb-3"},b.a.createElement(F,{username:n.me.username,friendCount:n.me.friendCount,friends:n.me.friends})):null))},te=a(37),ae=function(e){var t=Object(g.useState)({email:"",password:""}),a=Object(Y.a)(t,2),n=a[0],r=a[1],c=Object(U.a)(R),l=Object(Y.a)(c,2),o=l[0],i=l[1].error,s=function(e){var t=e.target,a=t.name,c=t.value;r(Object(v.a)(Object(v.a)({},n),{},Object(te.a)({},a,c)))},u=function(){var e=Object(L.a)(B.a.mark((function e(t){var a,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,o({variables:Object(v.a)({},n)});case 4:a=e.sent,c=a.data,$.login(c.login.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:r({email:"",password:""});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return b.a.createElement("main",{className:"flex-row justify-center mb-4"},b.a.createElement("div",{className:"col-12 col-md-6"},b.a.createElement("div",{className:"card"},b.a.createElement("h4",{className:"card-header"},"Login"),b.a.createElement("div",{className:"card-body"},b.a.createElement("form",{onSubmit:u},b.a.createElement("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:n.email,onChange:s}),b.a.createElement("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:n.password,onChange:s}),b.a.createElement("button",{className:"btn d-block w-100",type:"submit"},"Submit")),i&&b.a.createElement("div",null,"Login failed")))))},ne=function(){return b.a.createElement("div",null,"Oops, we couldn't find that page.")},re=function(e){var t=e.reactions;return b.a.createElement("div",{className:"card mb-3"},b.a.createElement("div",{className:"card-header"},b.a.createElement("span",{className:"text-light"},"Reactions")),b.a.createElement("div",{className:"card-body"},t&&t.map((function(e){return b.a.createElement("p",{className:"pill mb-3",key:e._id},e.reactionBody," //"," ",b.a.createElement(E.b,{to:"/profile/".concat(e.username),style:{fontWeight:700}},e.username," on ",e.createdAt))}))))},ce=function(e){var t=Object(j.g)().id,a=Object(Z.a)(H,{variables:{id:t}}),n=a.loading,r=a.data,c=(null===r||void 0===r?void 0:r.thought)||{};return n?b.a.createElement("div",null,"Loading..."):b.a.createElement("div",null,b.a.createElement("div",{className:"card mb-3"},b.a.createElement("p",{className:"card-header"},b.a.createElement("span",{style:{fontWeight:700},className:"text-light"},c.username)," ","thought on ",c.createdAt),b.a.createElement("div",{className:"card-body"},b.a.createElement("p",null,c.thoughtText))),c.reactionCount>0&&b.a.createElement(re,{reactions:c.reactions}))},le=function(e){var t=Object(j.g)().username,a=Object(U.a)(M),n=Object(Y.a)(a,1)[0],r=Object(Z.a)(t?V:G,{variables:{username:t}}),c=r.loading,l=r.data,o=(null===l||void 0===l?void 0:l.me)||(null===l||void 0===l?void 0:l.user)||{};if($.loggedIn()&&$.getProfile().data.username===t)return b.a.createElement(j.a,{to:"/profile"});if(c)return b.a.createElement("div",null,"Loading...");if(!(null===o||void 0===o?void 0:o.username))return b.a.createElement("h4",null,"You need to be logged in to see this. Use the navigation links above to sign up or log in!");var i=function(){var e=Object(L.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({variables:{id:o._id}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return b.a.createElement("div",null,b.a.createElement("div",{className:"flex-row mb-3"},b.a.createElement("h2",{className:"bg-dark text-secondary p-3 display-inline-block"},"Viewing ",t?"".concat(o.username,"'s"):"your"," profile."),t&&b.a.createElement("button",{className:"btn ml-auto",onClick:i},"Add Friend")),b.a.createElement("div",{className:"flex-row justify-space-between mb-3"},b.a.createElement("div",{className:"col-12 mb-3 col-lg-8"},b.a.createElement(A,{thoughts:o.thoughts,title:"".concat(o.username,"'s thoughts...")})),b.a.createElement("div",{className:"col-12 col-lg-3 mb-3"},b.a.createElement(F,{username:o.username,friendCount:o.friendCount,friends:o.friends}))),b.a.createElement("div",{className:"mb-3"},!t&&b.a.createElement(X,null)))},oe=function(){var e=Object(g.useState)({username:"",email:"",password:""}),t=Object(Y.a)(e,2),a=t[0],n=t[1],r=Object(U.a)(W),c=Object(Y.a)(r,2),l=c[0],o=c[1].error,i=function(e){var t=e.target,r=t.name,c=t.value;n(Object(v.a)(Object(v.a)({},a),{},Object(te.a)({},r,c)))},s=function(){var e=Object(L.a)(B.a.mark((function e(t){var n,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,l({variables:Object(v.a)({},a)});case 4:n=e.sent,r=n.data,$.login(r.addUser.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return b.a.createElement("main",{className:"flex-row justify-center mb-4"},b.a.createElement("div",{className:"col-12 col-md-6"},b.a.createElement("div",{className:"card"},b.a.createElement("h4",{className:"card-header"},"Sign Up"),b.a.createElement("div",{className:"card-body"},b.a.createElement("form",{onSubmit:s},b.a.createElement("input",{className:"form-input",placeholder:"Your username",name:"username",type:"username",id:"username",value:a.username,onChange:i}),b.a.createElement("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:a.email,onChange:i}),b.a.createElement("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:a.password,onChange:i}),b.a.createElement("button",{className:"btn d-block w-100",type:"submit"},"Submit")),o&&b.a.createElement("div",null,"Signup failed")))))},ie=Object(y.a)({uri:"/graphql"}),se=Object(x.a)((function(e,t){var a=t.headers,n=localStorage.getItem("id_token");return{headers:Object(v.a)(Object(v.a)({},a),{},{authorization:n?"Bearer ".concat(n):""})}})),ue=new O.a({link:se.concat(ie),cache:new w.a});var me=function(){return b.a.createElement(N.a,{client:ue},b.a.createElement(E.a,null,b.a.createElement("div",{className:"flex-column justify-flex-start min-100-vh"},b.a.createElement(T,null),b.a.createElement("div",{className:"container"},b.a.createElement(j.d,null,b.a.createElement(j.b,{exact:!0,path:"/",component:ee}),b.a.createElement(j.b,{exact:!0,path:"/login",component:ae}),b.a.createElement(j.b,{exact:!0,path:"/signup",component:oe}),b.a.createElement(j.b,{exact:!0,path:"/profile/:username?",component:le}),b.a.createElement(j.b,{exact:!0,path:"/thought/:id",component:ce}),b.a.createElement(j.b,{component:ne}))),b.a.createElement(I,null))))},de=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,102)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,l=t.getTTFB;a(e),n(e),r(e),c(e),l(e)}))};f.a.render(b.a.createElement(b.a.StrictMode,null,b.a.createElement(me,null)),document.getElementById("root")),de()}},[[73,1,2]]]);
//# sourceMappingURL=main.b465c1c5.chunk.js.map